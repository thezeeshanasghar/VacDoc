(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{"8vCw":function(l,n,e){"use strict";e.r(n);var t=e("8Y7J"),o=e("mrSG"),i=e("UXh4"),a=e("AytR"),u=e("h2J4"),s=e("Tw+x");class r{constructor(l,n,e,t,o,i){this.loadingController=l,this.followupService=n,this.toastService=e,this.storage=t,this.platform=o,this.downloader=i,this.followUpChild=[],this.numOfDays=0,this.selectedDate=(new Date).toISOString(),this.API_VACCINE=""+a.a.BASE_URL}ngOnInit(){this.storage.get(a.a.CLINIC_Id).then(l=>{this.clinicId=l}),this.getFollowupChild(this.selectedDate),this.storage.get(a.a.DOCTOR_Id).then(l=>{this.doctorId=l})}getFollowupChild(l){return o.a(this,void 0,void 0,(function*(){const n=yield this.loadingController.create({message:"Loading"});yield n.present(),yield this.followupService.getFollowupChild1(this.doctorId,l).subscribe(l=>{l.IsSuccess?(this.followUpChild=l.ResponseData,n.dismiss()):(n.dismiss(),this.toastService.create(l.Message,"danger"))},l=>{n.dismiss(),this.toastService.create(l,"danger")})}))}sendemails(){return o.a(this,void 0,void 0,(function*(){const l=yield this.loadingController.create({message:"sending follow up emails"});yield l.present(),yield this.followupService.sendEmailToAll(this.numOfDays,this.clinicId).subscribe(n=>{n.IsSuccess?(l.dismiss(),this.toastService.create("Follow up emails sent successfull","success")):(l.dismiss(),this.toastService.create(n.Message,"danger"))},n=>{l.dismiss(),this.toastService.create(n,"danger")})}))}downloadcsv(){let l="";this.followUpChild.map(l=>l.ChildId).forEach(n=>{n&&(l+="arr[]="+n+"&")});const n=`${this.API_VACCINE}FollowUp/export-followups-csv?${l}`;this.platform.is("desktop")||this.platform.is("mobileweb")?window.open(n,"_blank"):this.downloader.download({uri:n,title:"Child Alerts CSV",description:"Downloading follow-up alerts CSV",mimeType:"text/csv",visibleInDownloadsUi:!0,notificationVisibility:s.b.VisibleNotifyCompleted,destinationInExternalFilesDir:{dirType:"Downloads",subPath:"Child Alerts.csv"}}).then(l=>{console.log("File downloaded at:",l),this.toastService.create("File downloaded successfully","success")}).catch(l=>{console.error("Download failed:",l),this.toastService.create("Failed to download file","danger")})}formatDateToString(l){const n=new Date(l);return`${n.getFullYear()}-${("0"+(n.getMonth()+1)).slice(-2)}-${("0"+n.getDate()).slice(-2)}`}onDateChange(l){this.selectedDate=l.value,console.log("Selected Date:",this.selectedDate),this.getFollowups(this.selectedDate)}openDatePicker(){return o.a(this,void 0,void 0,(function*(){const l=document.querySelector("ion-datetime");yield l.open()}))}sendemail(l){return o.a(this,void 0,void 0,(function*(){console.log(l),console.log(l[0].ChildId);const n=yield this.loadingController.create({message:"sending email"});yield n.present(),yield this.followupService.sendFollowupMails(l[0].ChildId).subscribe(l=>{l.IsSuccess?(n.dismiss(),this.toastService.create("email sent successfully","success")):(n.dismiss(),this.toastService.create(l.Message,"danger"))},l=>{n.dismiss(),this.toastService.create(l,"danger")})}))}getFollowups(l){const n=this.formatDateToString(l);this.getFollowupChild(n)}openWhatsApp(l,n,e){if(console.log("Child Name:",n),console.log("Next Visit Date:",e),""===l.trim())return void alert("Invalid mobile number. Please provide a valid number.");const t=encodeURIComponent(`Reminder: Follow-up visit for ${n} is scheduled on ${e}.\nPlease confirm your appointment. Thanks!\nBaby Medics\nLogin and check your record at https://vaccinationcentre.com`),o=l.startsWith("+92")?l:"+92"+l.replace(/^0/,"");let i;i=this.platform.is("android")||this.platform.is("ios")?`whatsapp://send?phone=${o}&text=${t}`:`https://web.whatsapp.com/send?phone=${o}&text=${t}`,window.open(i,"_system")}}class c{}var d=e("pMnS"),b=e("t68o"),p=e("zbXB"),h=e("MKJQ"),m=e("sZkV"),g=e("HsOI"),f=e("ZwOa"),D=e("s7LF"),w=e("821u"),v=e("Xd0L"),C=e("/HVE"),k=e("oapL"),y=e("s6ns"),B=e("QQfA"),I=e("IP0z"),x=e("SVse"),S=e("4zgz"),q=e("xgBC"),_=t.pb({encapsulation:2,styles:[],data:{}});function N(l){return t.Nb(0,[(l()(),t.rb(0,0,null,null,1,"h1",[["style","color: red"]],null,null,null,null,null)),(l()(),t.Lb(-1,null,["No follow up for today."]))],null,null)}function F(l){return t.Nb(0,[(l()(),t.rb(0,0,null,null,8,"ion-item",[],null,null,null,h.xb,h.y)),t.qb(1,49152,null,0,m.H,[t.h,t.k,t.x],null,null),(l()(),t.rb(2,0,null,0,2,"ion-label",[],null,null,null,h.yb,h.z)),t.qb(3,49152,null,0,m.N,[t.h,t.k,t.x],null,null),(l()(),t.Lb(4,0,["",""])),(l()(),t.rb(5,0,null,0,1,"ion-icon",[["color","primary"],["name","mail"],["slot","end"],["style","cursor: pointer;"]],null,[[null,"click"]],(function(l,n,e){var t=!0;return"click"===n&&(t=!1!==l.component.sendemail([l.context.$implicit])&&t),t}),h.sb,h.t)),t.qb(6,49152,null,0,m.C,[t.h,t.k,t.x],{color:[0,"color"],name:[1,"name"]},null),(l()(),t.rb(7,0,null,0,1,"ion-icon",[["name","logo-whatsapp"],["slot","end"],["style","cursor: pointer"]],null,[[null,"click"]],(function(l,n,e){var t=!0;return"click"===n&&(t=!1!==l.component.openWhatsApp(l.context.$implicit.Child.User.MobileNumber,l.context.$implicit.Child.Name,l.context.$implicit.NextVisitDate)&&t),t}),h.sb,h.t)),t.qb(8,49152,null,0,m.C,[t.h,t.k,t.x],{color:[0,"color"],name:[1,"name"]},null)],(function(l,n){l(n,6,0,"primary","mail"),l(n,8,0,n.context.$implicit.isMessageSent?"primary":"success","logo-whatsapp")}),(function(l,n){l(n,4,0,n.context.$implicit.Child.Name)}))}function U(l){return t.Nb(0,[(l()(),t.rb(0,0,null,null,42,"ion-content",[["class","ion-padding"]],null,null,null,h.mb,h.n)),t.qb(1,49152,null,0,m.u,[t.h,t.k,t.x],null,null),(l()(),t.rb(2,0,null,0,30,"ion-toolbar",[],null,null,null,h.Xb,h.Y)),t.qb(3,49152,null,0,m.zb,[t.h,t.k,t.x],null,null),(l()(),t.rb(4,0,null,0,7,"ion-buttons",[["slot","start"]],null,null,null,h.eb,h.f)),t.qb(5,49152,null,0,m.l,[t.h,t.k,t.x],null,null),(l()(),t.rb(6,0,null,0,2,"ion-button",[["color","primary"],["fill","outline"]],null,[[null,"click"]],(function(l,n,e){var t=!0;return"click"===n&&(t=!1!==l.component.sendemails()&&t),t}),h.db,h.e)),t.qb(7,49152,null,0,m.k,[t.h,t.k,t.x],{color:[0,"color"],disabled:[1,"disabled"],fill:[2,"fill"]},null),(l()(),t.Lb(-1,0,["Email"])),(l()(),t.rb(9,0,null,0,2,"ion-button",[["color","primary"],["fill","outline"]],null,[[null,"click"]],(function(l,n,e){var t=!0;return"click"===n&&(t=!1!==l.component.downloadcsv()&&t),t}),h.db,h.e)),t.qb(10,49152,null,0,m.k,[t.h,t.k,t.x],{color:[0,"color"],disabled:[1,"disabled"],fill:[2,"fill"]},null),(l()(),t.Lb(-1,0,["Sheet"])),(l()(),t.rb(12,0,null,0,20,"ion-buttons",[["slot","end"]],null,null,null,h.eb,h.f)),t.qb(13,49152,null,0,m.l,[t.h,t.k,t.x],null,null),(l()(),t.rb(14,0,null,0,18,"ion-item",[],null,[[null,"click"]],(function(l,n,e){var o=!0;return"click"===n&&(o=!1!==t.Db(l,32).open()&&o),o}),h.xb,h.y)),t.qb(15,49152,null,0,m.H,[t.h,t.k,t.x],null,null),(l()(),t.rb(16,0,null,0,10,"input",[["class","mat-input-element mat-form-field-autofill-control"],["matInput",""]],[[1,"aria-haspopup",0],[1,"aria-owns",0],[1,"min",0],[1,"max",0],[8,"disabled",0],[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null],[2,"mat-input-server",null],[1,"id",0],[1,"placeholder",0],[8,"disabled",0],[8,"required",0],[1,"readonly",0],[1,"aria-describedby",0],[1,"aria-invalid",0],[1,"aria-required",0]],[[null,"ngModelChange"],[null,"dateChange"],[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"],[null,"change"],[null,"keydown"],[null,"focus"]],(function(l,n,e){var o=!0,i=l.component;return"input"===n&&(o=!1!==t.Db(l,18)._handleInput(e.target.value)&&o),"blur"===n&&(o=!1!==t.Db(l,18).onTouched()&&o),"compositionstart"===n&&(o=!1!==t.Db(l,18)._compositionStart()&&o),"compositionend"===n&&(o=!1!==t.Db(l,18)._compositionEnd(e.target.value)&&o),"input"===n&&(o=!1!==t.Db(l,19)._onInput(e.target.value)&&o),"change"===n&&(o=!1!==t.Db(l,19)._onChange()&&o),"blur"===n&&(o=!1!==t.Db(l,19)._onBlur()&&o),"keydown"===n&&(o=!1!==t.Db(l,19)._onKeydown(e)&&o),"blur"===n&&(o=!1!==t.Db(l,26)._focusChanged(!1)&&o),"focus"===n&&(o=!1!==t.Db(l,26)._focusChanged(!0)&&o),"input"===n&&(o=!1!==t.Db(l,26)._onInput()&&o),"ngModelChange"===n&&(o=!1!==(i.selectedDate=e)&&o),"dateChange"===n&&(o=!1!==i.onDateChange(e)&&o),o}),null,null)),t.Ib(6144,null,g.c,null,[f.b]),t.qb(18,16384,null,0,D.c,[t.C,t.k,[2,D.a]],null,null),t.qb(19,147456,null,0,w.h,[t.k,[2,v.a],[2,v.d],[2,g.b]],{matDatepicker:[0,"matDatepicker"]},{dateChange:"dateChange"}),t.Ib(1024,null,D.m,(function(l){return[l]}),[w.h]),t.Ib(1024,null,D.n,(function(l,n){return[l,n]}),[D.c,w.h]),t.qb(22,671744,null,0,D.s,[[8,null],[6,D.m],[8,null],[6,D.n]],{model:[0,"model"]},{update:"ngModelChange"}),t.Ib(2048,null,D.o,null,[D.s]),t.qb(24,16384,null,0,D.p,[[4,D.o]],null,null),t.Ib(2048,null,f.a,null,[w.h]),t.qb(26,999424,null,0,f.b,[t.k,C.a,[6,D.o],[2,D.r],[2,D.j],v.b,[6,f.a],k.a,t.x],null,null),(l()(),t.rb(27,0,null,0,3,"mat-datepicker-toggle",[["class","mat-datepicker-toggle"],["matSuffix",""]],[[1,"tabindex",0],[2,"mat-datepicker-toggle-active",null],[2,"mat-accent",null],[2,"mat-warn",null]],[[null,"focus"]],(function(l,n,e){var o=!0;return"focus"===n&&(o=!1!==t.Db(l,28)._button.focus()&&o),o}),p.e,p.d)),t.qb(28,1753088,null,1,w.k,[w.i,t.h,[8,null]],{datepicker:[0,"datepicker"]},null),t.Jb(603979776,1,{_customIcon:0}),t.qb(30,16384,null,0,g.e,[],null,null),(l()(),t.rb(31,16777216,null,0,1,"mat-datepicker",[],null,null,null,p.f,p.c)),t.qb(32,180224,[["picker",4]],0,w.f,[y.d,B.a,t.x,t.N,w.a,[2,v.a],[2,I.b],[2,x.d]],null,null),(l()(),t.gb(16777216,null,0,1,null,N)),t.qb(34,16384,null,0,x.m,[t.N,t.K],{ngIf:[0,"ngIf"]},null),(l()(),t.rb(35,0,null,0,7,"ion-grid",[],null,null,null,h.qb,h.r)),t.qb(36,49152,null,0,m.A,[t.h,t.k,t.x],null,null),(l()(),t.rb(37,0,null,0,5,"ion-row",[],null,null,null,h.Jb,h.K)),t.qb(38,49152,null,0,m.gb,[t.h,t.k,t.x],null,null),(l()(),t.rb(39,0,null,0,3,"ion-col",[],null,null,null,h.lb,h.m)),t.qb(40,49152,null,0,m.t,[t.h,t.k,t.x],null,null),(l()(),t.gb(16777216,null,0,1,null,F)),t.qb(42,278528,null,0,x.l,[t.N,t.K,t.q],{ngForOf:[0,"ngForOf"]},null)],(function(l,n){var e=n.component;l(n,7,0,"primary",!e.followUpChild||0===e.followUpChild.length,"outline"),l(n,10,0,"primary",!e.followUpChild||0===e.followUpChild.length,"outline"),l(n,19,0,t.Db(n,32)),l(n,22,0,e.selectedDate),l(n,26,0),l(n,28,0,t.Db(n,32)),l(n,34,0,!e.followUpChild||0===e.followUpChild.length),l(n,42,0,e.followUpChild)}),(function(l,n){l(n,16,1,[t.Db(n,19)._datepicker?"dialog":null,(null==t.Db(n,19)._datepicker?null:t.Db(n,19)._datepicker.opened)&&t.Db(n,19)._datepicker.id||null,t.Db(n,19).min?t.Db(n,19)._dateAdapter.toIso8601(t.Db(n,19).min):null,t.Db(n,19).max?t.Db(n,19)._dateAdapter.toIso8601(t.Db(n,19).max):null,t.Db(n,19).disabled,t.Db(n,24).ngClassUntouched,t.Db(n,24).ngClassTouched,t.Db(n,24).ngClassPristine,t.Db(n,24).ngClassDirty,t.Db(n,24).ngClassValid,t.Db(n,24).ngClassInvalid,t.Db(n,24).ngClassPending,t.Db(n,26)._isServer,t.Db(n,26).id,t.Db(n,26).placeholder,t.Db(n,26).disabled,t.Db(n,26).required,t.Db(n,26).readonly&&!t.Db(n,26)._isNativeSelect||null,t.Db(n,26)._ariaDescribedby||null,t.Db(n,26).errorState,t.Db(n,26).required.toString()]),l(n,27,0,-1,t.Db(n,28).datepicker&&t.Db(n,28).datepicker.opened,t.Db(n,28).datepicker&&"accent"===t.Db(n,28).datepicker.color,t.Db(n,28).datepicker&&"warn"===t.Db(n,28).datepicker.color)}))}function A(l){return t.Nb(0,[(l()(),t.rb(0,0,null,null,2,"app-follow-up",[],null,null,null,U,_)),t.Ib(4608,null,S.a,S.a,[]),t.qb(2,114688,null,0,r,[m.Db,u.a,i.a,q.b,m.Hb,s.a],null,null)],(function(l,n){l(n,2,0)}),null)}var $=t.nb("app-follow-up",r,A,{},{},[]),M=e("POq0"),O=e("iInd"),V=e("cUpR"),j=e("Fwaw"),E=e("zMNK"),L=e("hOhj"),P=e("5GAg");e.d(n,"FollowUpPageModuleNgFactory",(function(){return T}));var T=t.ob(c,[],(function(l){return t.Ab([t.Bb(512,t.j,t.Z,[[8,[d.a,b.a,p.b,p.a,$]],[3,t.j],t.v]),t.Bb(4608,x.o,x.n,[t.s,[2,x.D]]),t.Bb(4608,D.y,D.y,[]),t.Bb(4608,m.b,m.b,[t.x,t.g]),t.Bb(4608,m.Eb,m.Eb,[m.b,t.j,t.p]),t.Bb(4608,m.Ib,m.Ib,[m.b,t.j,t.p]),t.Bb(4608,B.a,B.a,[B.g,B.c,t.j,B.f,B.d,t.p,t.x,x.d,I.b,[2,x.i]]),t.Bb(5120,B.h,B.i,[B.a]),t.Bb(5120,y.b,y.c,[B.a]),t.Bb(135680,y.d,y.d,[B.a,t.p,[2,x.i],[2,y.a],y.b,[3,y.d],B.c]),t.Bb(4608,M.c,M.c,[]),t.Bb(4608,w.i,w.i,[]),t.Bb(5120,w.a,w.b,[B.a]),t.Bb(4608,v.b,v.b,[]),t.Bb(4608,v.a,v.u,[[2,v.e],C.a]),t.Bb(4608,s.a,s.a,[]),t.Bb(1073742336,x.b,x.b,[]),t.Bb(1073742336,D.x,D.x,[]),t.Bb(1073742336,D.l,D.l,[]),t.Bb(1073742336,m.Bb,m.Bb,[]),t.Bb(1073742336,O.q,O.q,[[2,O.v],[2,O.n]]),t.Bb(1073742336,I.a,I.a,[]),t.Bb(1073742336,v.j,v.j,[[2,v.c],[2,V.f]]),t.Bb(1073742336,C.b,C.b,[]),t.Bb(1073742336,v.t,v.t,[]),t.Bb(1073742336,j.c,j.c,[]),t.Bb(1073742336,E.f,E.f,[]),t.Bb(1073742336,L.b,L.b,[]),t.Bb(1073742336,B.e,B.e,[]),t.Bb(1073742336,y.g,y.g,[]),t.Bb(1073742336,M.d,M.d,[]),t.Bb(1073742336,P.a,P.a,[]),t.Bb(1073742336,w.j,w.j,[]),t.Bb(1073742336,k.c,k.c,[]),t.Bb(1073742336,g.d,g.d,[]),t.Bb(1073742336,f.c,f.c,[]),t.Bb(1073742336,v.v,v.v,[]),t.Bb(1073742336,v.l,v.l,[]),t.Bb(1073742336,c,c,[]),t.Bb(256,v.d,v.g,[]),t.Bb(1024,O.l,(function(){return[[{path:"",component:r}]]}),[])])}))}}]);